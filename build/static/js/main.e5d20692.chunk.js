(this["webpackJsonpreact-client-pw"]=this["webpackJsonpreact-client-pw"]||[]).push([[0],{27:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(14),o=n.n(a),i=(n(27),n(12)),s=n.n(i),l=n(15),j=n(8),u=n(5),b=n(0),d=function(e){var t=e.text,n=e.onClickx,c=e.color;return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn",style:{backgroundColor:c},onClick:n,children:t})})};d.defaultProps={color:"steelblue",text:"Button"};var p,h,f,O=d,x=function(e){var t=e.title,n=e.onClickx,c=e.show;return Object(b.jsxs)("div",{className:"header",children:[Object(b.jsxs)("h2",{children:[" ",t," "]}),Object(b.jsx)(O,{onClickx:n,text:c?"Hide":"Show",color:c?"blue":"green"})]})},v=n(2),y=n(20),g=[],m=[],w=400,C=400;function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0===e?16735760:1===e?16744096:2===e?14515712:16777215}function E(e,t){e.push(e[0]);for(var n=0;n<e.length-1;n++)for(var c=[new v.t(e[n].x,e[n].y,e[n].z),new v.t(e[n+1].x,e[n+1].y,e[n+1].z)],r=(new v.c).setFromPoints(c),a=new v.h({color:0}),o=new v.g(r,a),i=0;i<t;i+=3){var s=o.clone();s.position.z=i,g.push(s)}}function F(e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.75,c=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;"site"!==r&&E(e,t);var a=0;"peripheral"===r?a=S(0):"partition"===r?a=S(1):"courtyard"===r?a=S(2):"site"===r&&(a=S(3));var o=new v.o;o.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)o.lineTo(e[i].x,e[i].y);o.autoClose=!0;var s={steps:1,depth:t,bevelEnabled:!1},l=new v.f(o,s),j=new v.k({color:a,opacity:n,transparent:!0,wireframe:c}),u=new v.j(l,j);m.push(u)}var k=function(e){var t=e.dataFromServerInp,n=Object(c.useState)(t),r=Object(u.a)(n,2),a=(r[0],r[1]);Object(c.useEffect)((function(){a(t),o()}),[t]);var o=function(){console.log(t),a(t);for(var e=document.getElementById("viewerDiv3d");e.children.length>0;)e.removeChild(e.firstChild);(p=new v.n).background=new v.d("#ffffff"),(h=new v.l(45,1,.01,1e5)).position.set(250,250,550),h.up=new v.t(0,0,1),(f=new v.u).setSize(w,C),e.appendChild(f.domElement),function(){var e=new v.a(16777215);p.add(e)}(),function(e){m.forEach((function(e){e.geometry.dispose(),e.material.dispose(),p.remove(e)})),g.forEach((function(e){e.geometry.dispose(),e.material.dispose(),p.remove(e)})),g=[],m=[];var t=0;try{var n=e.partitions,c=0,r=0,a=0;n.forEach((function(e){c+=e.parcel.area,r+=e.parcel.building_height,a++}));var o=10*r/a,i=.1*c/a;n.forEach((function(e){n[t];var c=e.parcel.area,r=e.parcel.building_height,a=e.parcel.type;try{("peripheral"===a||"courtyard"===a||"partition"===a&&r<o&&c>i)&&F(e.parcel.footprint_poly_points,r,0,.75,!1,a)}catch(s){}t++}))}catch(h){}try{var s=e.site;console.log(s);var l=new v.o;l.moveTo(s[0].x,s[0].y);for(var j=1;j<s.length;j++)l.lineTo(s[j].x,s[j].y);l.autoClose=!0;var u=new v.f(l,{steps:1,depth:12.5,bevelEnabled:!1}),b=new v.k({color:7827456,opacity:.5,transparent:!0,wireframe:!1}),d=new v.j(u,b);d.position.z=-12.5,m.push(d)}catch(h){}m.forEach((function(e){p.add(e)})),g.forEach((function(e){p.add(e)}))}(t);var n=new v.b(150);p.add(n);new y.a(h,f.domElement).addEventListener("onchange",(function(){h.aspect=1,h.updateProjectionMatrix(),f.setSize(w,C)})),i()},i=function e(){requestAnimationFrame(e),f.render(p,h)};return Object(b.jsx)("div",{})},_=function(e){var t=e.onGetConstraints,n=Object(c.useState)(!0),r=Object(u.a)(n,2),a=r[0],o=r[1],i=Object(c.useState)(!0),s=Object(u.a)(i,2),l=s[0],j=s[1],d=Object(c.useState)(5),p=Object(u.a)(d,2),h=p[0],f=p[1],O=Object(c.useState)(1.25),x=Object(u.a)(O,2),v=x[0],y=x[1],g=Object(c.useState)(3),m=Object(u.a)(g,2),w=m[0],C=m[1],S=Object(c.useState)(52),E=Object(u.a)(S,2),F=E[0],k=E[1],_=Object(c.useState)(7),D=Object(u.a)(_,2),N=D[0],z=D[1],T=Object(c.useState)(0),L=Object(u.a)(T,2),P=L[0],I=L[1],G=Object(c.useState)(35),R=Object(u.a)(G,2),A=R[0],B=R[1],M=Object(c.useState)(3),H=Object(u.a)(M,2),J=H[0],q=H[1];Object(c.useEffect)((function(){}),[a]),Object(c.useEffect)((function(){}),[l]),Object(c.useEffect)((function(){}),[h]),Object(c.useEffect)((function(){}),[v]),Object(c.useEffect)((function(){}),[w]),Object(c.useEffect)((function(){}),[F]),Object(c.useEffect)((function(){}),[N]),Object(c.useEffect)((function(){}),[P]),Object(c.useEffect)((function(){}),[A]),Object(c.useEffect)((function(){}),[J]);return Object(b.jsx)("div",{children:Object(b.jsx)("form",{className:"add-form",onSubmit:function(e){e.preventDefault(),t({peripheral:a,subdivision:l,number:parseInt(h),fsr:parseFloat(v),floorHeight:parseFloat(w),peripheralDepth:parseFloat(F),setback:parseFloat(N),deviation:parseFloat(P),courtyard_depth:parseFloat(A),courtyard_number:parseFloat(J)}),o(!0),j(!0),f(parseInt(h)),y(parseFloat(v)),C(parseFloat(w)),k(parseFloat(F)),z(parseFloat(N)),I(P),B(parseFloat(A)),q(parseFloat(J))},children:Object(b.jsxs)("div",{className:"form-control",children:[Object(b.jsx)("table",{children:Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsxs)("label",{children:["Floor Area Ratio (FAR) or Floor Space Ratio (FSR)"," "]})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:v,onChange:function(e){return y(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Floor Height (partition)"})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:w,onChange:function(e){return C(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Setback "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"1.0",value:N,onChange:function(e){return z(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Number of internal subdivisions "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"5",value:h,onChange:function(e){return f(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Depth of Peripheral Arrangement "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:F,onChange:function(e){return k(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Deviation in subdivision/partitions "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:P,onChange:function(e){return I(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Number of Courtyard-Type "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:J,onChange:function(e){return q(e.target.value)}})})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:Object(b.jsx)("label",{children:"Depth of Bays in Courtyard-Type "})}),Object(b.jsx)("td",{children:Object(b.jsx)("input",{type:"text",placeholder:"3",value:A,onChange:function(e){return B(e.target.value)}})})]})]})}),Object(b.jsx)("div",{children:Object(b.jsx)("input",{type:"submit",value:"submit",className:"btn btn-block",onClick:function(){f(h),y(v),C(w),k(F),z(N),I(P),B(A),q(J)}})})]})})})},D=function(e){var t=e.title,n=e.onClickx,c=e.btnTitle;return Object(b.jsxs)("div",{className:"header",children:[Object(b.jsxs)("h2",{children:[" ",t," "]}),Object(b.jsx)(O,{onClickx:n,text:c,color:"blue"})]})},N=n(21),z=n(38),T=n(39),L=n(40),P=n(6),I=n.n(P),G=n(22);n(33),n(34);var R=function(e){var t=e.onGetMapPolyCoords,n=Object(c.useState)([]),r=Object(u.a)(n,2),a=(r[0],r[1]),o=Object(c.useState)([{x:-200,y:-200},{x:200,y:-200},{x:200,y:200},{x:-200,y:200}]),i=Object(u.a)(o,2),s=i[0],l=i[1],j=Object(c.useState)({lat:48.864716,lng:2.349}),d=Object(u.a)(j,2),p=d[0];d[1];Object(c.useEffect)((function(){console.log(s)}),[s]);var h=function(e){var t=[],n=e[0],c=0,r=0;e.forEach((function(e){var a=[parseFloat(e[0])-parseFloat(n[0]),parseFloat(e[1])-parseFloat(n[1])];t.push({x:a[0].toFixed(4),y:a[1].toFixed(4)}),c+=a[0],r+=a[1]})),console.log("created map",e);var a=c/e.length,o=r/e.length,i=[];t.forEach((function(e){var t=[parseFloat(e.x)-a,parseFloat(e.y)-o];i.push({x:t[0],y:t[1]})}));var s=[],j=100,u=0,b=j*j+u*u;i.forEach((function(e){var t=e.x-j,n=e.y-u,c=(j*t+u*n)/b,r={x:2*j*c-e.x,y:2*u*c-e.y};s.push(r)})),l(s)};return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"map_container",children:Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(s)},children:[Object(b.jsxs)(z.a,{center:p,zoom:13,children:[Object(b.jsx)(T.a,{children:Object(b.jsx)(G.a,{position:"topright",onCreated:function(e){var t=[],n=e.layerType,c=e.layer;if("polygon"===n){var r=c._leaflet_id;a((function(e){return[].concat(Object(N.a)(e),[{id:r,latlngs:c.getLatLngs()[0]}])})),console.log(c.getLatLngs()[0]),c.getLatLngs()[0].forEach((function(e){var n=I.a.CRS.EPSG3857.project(I.a.latLng(e));t.push([n.y,n.x])})),t.push(t[0])}h(t)},onEdited:function(e){var t=e.layers._layers,n=Object.values(t)[0].editing.latlngs[0][0],c=[];n.forEach((function(e){var t=I.a.CRS.EPSG3857.project(I.a.latLng(e));c.push([t.y,t.x])})),h(c)},onDeleted:function(e){var t=e.layers._layers;Object.values(t).map((function(e){var t=e._leaflet_id;a((function(e){return e.filter((function(e){return e.id!==t}))}))})),l([{x:-200,y:-200},{x:200,y:-200},{x:200,y:200},{x:-200,y:200}])},draw:{rectangle:!1,polyline:!1,circle:!1,marker:!1,circlemarker:!1}})}),Object(b.jsx)(L.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})]}),Object(b.jsx)("div",{children:Object(b.jsx)("input",{type:"submit",value:"submit",className:"btn btn-block",onClick:function(){l(s)}})})]})})})};var A=function(){var e=Object(c.useState)(),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),o=Object(u.a)(a,2),i=o[0],d=o[1],p=Object(c.useState)(!1),h=Object(u.a)(p,2),f=h[0],O=h[1],v=Object(c.useState)(!1),y=Object(u.a)(v,2),g=y[0],m=y[1],w=Object(c.useState)({peripheral:!0,subdivision:!0,number:5,fsr:1.25,floorHeight:3,peripheralDepth:52,setback:7,deviation:.5,courtyard_depth:35,courtyard_number:3}),C=Object(u.a)(w,2),S=C[0],E=C[1],F=Object(c.useState)([{x:-200,y:-200},{x:200,y:-200},{x:200,y:200},{x:-200,y:200}]),N=Object(u.a)(F,2),z=N[0],T=N[1],L=Object(c.useState)(Object(j.a)(Object(j.a)({},S),{},{polygon:z})),P=Object(u.a)(L,2),I=P[0],G=P[1];Object(c.useEffect)((function(){A(),m(g)}),[I]);var A=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://apipw2.azurewebsites.net/api/post/composed_solution",e.next=3,fetch("https://apipw2.azurewebsites.net/api/post/composed_solution",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,r(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("h1",{children:[Object(b.jsx)("b",{children:"Architecture & Urban Design Client"}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{})]}),Object(b.jsx)("br",{}),Object(b.jsx)(x,{title:"Input constraints",show:i,onClickx:function(){d(!i)}}),i&&Object(b.jsx)(_,{onGetConstraints:function(e){E(e)}}),Object(b.jsx)(x,{title:"Draw the site on a map",show:f,onClickx:function(){O(!f)}}),f&&Object(b.jsx)(R,{onGetMapPolyCoords:function(e){T(e)}}),Object(b.jsx)(D,{title:"Generate a solution",btnTitle:"Process",onClickx:function(){G(Object(j.a)(Object(j.a)({},S),{},{polygon:z})),A()}}),Object(b.jsx)(x,{title:"View results",show:g,onClickx:function(){m(!g);for(var e=document.getElementById("viewerDiv3d");e.children.length>0;)e.removeChild(e.firstChild)}}),g&&Object(b.jsx)(k,{dataFromServerInp:n}),Object(b.jsx)("div",{id:"viewerDiv3d"})]})};o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(A,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.e5d20692.chunk.js.map